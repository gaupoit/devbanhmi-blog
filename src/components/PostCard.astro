---
import { formatDate, getFeaturedImageUrl, getPostCategories, getExcerptText, type WPPost } from '../lib/wordpress';

interface Props {
  post: WPPost;
}

const { post } = Astro.props;
const featuredImage = getFeaturedImageUrl(post, 'medium_large');
const categories = getPostCategories(post);
const excerpt = getExcerptText(post.excerpt.rendered, 120);
---

<article class="group">
  <a href={`/blog/${post.slug}`} class="block">
    {featuredImage && (
      <img
        src={featuredImage}
        alt={post.title.rendered}
        class="mb-4 aspect-video w-full rounded-lg object-cover transition-opacity group-hover:opacity-90"
        loading="lazy"
      />
    )}

    {categories.length > 0 && (
      <div class="mb-2 flex gap-2">
        {categories.slice(0, 2).map((cat) => (
          <span class="text-xs font-medium uppercase tracking-wide text-blue-600 dark:text-blue-400">
            {cat.name}
          </span>
        ))}
      </div>
    )}

    <h2
      class="text-xl font-semibold tracking-tight group-hover:text-gray-600 dark:group-hover:text-gray-300"
      set:html={post.title.rendered}
    />

    <p class="mt-2 text-gray-600 dark:text-gray-400">{excerpt}</p>

    <time class="mt-3 block text-sm text-gray-500 dark:text-gray-500" datetime={post.date}>
      {formatDate(post.date)}
    </time>
  </a>
</article>
